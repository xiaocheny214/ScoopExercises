import{a5 as O,r as a}from"./index-BVGhpotA.js";const T=O("question",()=>{const v=a([]),Q=a([]),s=a(null),n=a(0),u=a([]),i=a(!1),f=e=>{v.value=e},A=e=>{Q.value=e},m=e=>{console.log("开始答题，试卷数据:",e),s.value=e,n.value=0,u.value=[],i.value=!0,console.log("答题状态已设置:",{isAnswering:i.value,currentPaper:s.value})},g=(e,o)=>{u.value[e]!==void 0&&(u.value[e]=o)},w=()=>{const e=p();return n.value<e-1?(n.value++,!0):!1},d=()=>n.value>0?(n.value--,!0):!1,p=()=>s.value?(s.value.multipleChoiceQuestions?.length||0)+(s.value.analysisQuestions?.length||0)+(s.value.essayQuestions?.length||0):0,I=()=>{if(!s.value)return null;const e=s.value.multipleChoiceQuestions||[],o=s.value.analysisQuestions||[],r=s.value.essayQuestions||[];return[...e.map(l=>({...l,type:"MULTIPLE_CHOICE"})),...o.map(l=>({...l,type:"ANALYSIS"})),...r.map(l=>({...l,type:"ESSAY"}))].sort((l,t)=>(l.sortOrder||0)-(t.sortOrder||0))[n.value]||null},S=()=>{i.value=!1;const e={paperId:s.value?.id,answers:u.value.map((o,r)=>{const c=y(r);return{questionType:c?.type||"MULTIPLE_CHOICE",questionId:c?.id||r,userAnswer:o,scoreObtained:0}}),finishTime:new Date().toISOString()};return s.value=null,n.value=0,u.value=[],e},y=e=>{if(!s.value)return null;const o=s.value.multipleChoiceQuestions||[],r=s.value.analysisQuestions||[],c=s.value.essayQuestions||[];return[...o.map(t=>({...t,type:"MULTIPLE_CHOICE"})),...r.map(t=>({...t,type:"ANALYSIS"})),...c.map(t=>({...t,type:"ESSAY"}))].sort((t,C)=>(t.sortOrder||0)-(C.sortOrder||0))[e]||null};return{questionBanks:v,papers:Q,currentPaper:s,currentQuestionIndex:n,userAnswers:u,isAnswering:i,setQuestionBanks:f,setPapers:A,setQuestions:e=>{s.value&&(s.value.questions=e)},initUserAnswers:e=>{u.value=new Array(e).fill("")},startAnswering:m,submitAnswer:g,nextQuestion:w,prevQuestion:d,finishAnswering:S,resetAnswering:()=>{s.value=null,n.value=0,u.value=[],i.value=!1},getTotalQuestions:p,getCurrentQuestion:I,getCurrentQuestionByIndex:y}});export{T as u};
