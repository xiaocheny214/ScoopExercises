import{r as w,a6 as G,m as C,p as F,E as T,c as r,b as s,t as n,h,d as l,w as p,f as m,a3 as J,Q as E,R as H,Y as k,g as W,o as i,j as y,a7 as X,K as Z,a8 as K,$ as ss}from"./index-D6KW0YUS.js";import{u as es}from"./history-BXQJllDi.js";import{a as ts,b as as}from"./format-XwD1px1m.js";import{_ as ns}from"./_plugin-vue_export-helper-DlAUqK2U.js";const os={class:"history-detail-container"},ls={class:"detail-header"},rs={class:"header-info"},is={class:"header-meta"},cs={class:"header-actions"},us={key:0,class:"loading-container"},ds={key:1,class:"detail-content"},vs={class:"detail-area"},_s={class:"question-nav"},ps={class:"nav-grid"},ms=["onClick","title"],fs={class:"nav-stats"},ws={class:"stat-item"},hs={class:"stat-value"},ys={class:"stat-item"},gs={class:"stat-value correct"},Cs={class:"stat-item"},ks={class:"stat-value incorrect"},As={class:"stat-item"},bs={class:"stat-value"},Ts={class:"question-content"},Ss={key:0,class:"question-wrapper"},xs={class:"question-header"},Is={class:"question-number"},Es={class:"question-type"},Hs={class:"question-score"},Ns={class:"question-body"},Qs={class:"question-text"},$s={key:0,class:"question-options"},qs={class:"option-label"},Ls={class:"option-text"},Ds={key:0,class:"answer-mark correct"},Vs={key:1,class:"answer-mark wrong"},Ms={class:"answer-summary"},Os={class:"answer-row"},Bs={class:"answer-value correct"},Ys={class:"answer-row"},js={key:1,class:"text-answers"},zs={class:"answer-section"},Ps={class:"answer-title"},Us={class:"answer-content standard"},Rs={class:"answer-section"},Gs={class:"question-actions"},Fs={class:"nav-buttons"},Js={class:"jump-input"},Ws={key:1,class:"no-question"},Xs={key:2,class:"error-container"},Zs={__name:"HistoryDetail",setup(Ks){const S=G(),f=W(),N=es(),A=w(!1),o=w(null),Q=w(S.params.id),u=w(0),b=w(1),v=C(()=>{if(!o.value?.userAnswer)return[];const e=[];return o.value.userAnswer.multipleChoice&&e.push(...o.value.userAnswer.multipleChoice),o.value.userAnswer.analysis&&e.push(...o.value.userAnswer.analysis),o.value.userAnswer.essay&&e.push(...o.value.userAnswer.essay),e}),a=C(()=>v.value[u.value]||null),$=C(()=>v.value.filter(e=>e.isCorrect===!0).length),q=C(()=>v.value.filter(e=>e.isCorrect===!1).length);F(()=>{L()});const L=async()=>{A.value=!0;try{const e=await N.getHistoryDetail(Q.value);e.success?(o.value=e.data,console.log("详情数据:",e.data)):T.error(e.message||"加载详情失败")}catch(e){console.error("加载详情失败:",e),T.error("加载详情失败")}finally{A.value=!1}},D=()=>{const e=S.query.from;if(e==="home")f.push({name:"Home"});else if(e==="history")f.push({name:"History"});else try{window.history.length>1?f.go(-1):f.push({name:"History"})}catch{f.push({name:"History"})}},V=e=>{e>=0&&e<v.value.length&&(u.value=e)},M=()=>{u.value>0&&u.value--},O=()=>{u.value<v.value.length-1&&u.value++},B=()=>{const e=b.value-1;e>=0&&e<v.value.length?u.value=e:T.warning("请输入有效的题目序号")},Y=(e,t)=>{let _=`第${t+1}题 - ${x(e.questionType)}`;return e.isCorrect===!0?_+=`
✓ 正确 (${e.scoreObtained}/${e.maxScore}分)`:e.isCorrect===!1?_+=`
✗ 错误 (${e.scoreObtained}/${e.maxScore}分)`:_+=`
待评分 (${e.scoreObtained}/${e.maxScore}分)`,_},x=e=>({MULTIPLE_CHOICE:"选择题",ANALYSIS:"分析题",ESSAY:"解答题"})[e]||"题目",j=e=>e===!0?"success":e===!1?"danger":"warning",z=e=>e===!0?"正确":e===!1?"错误":"待评分";return(e,t)=>{const _=m("el-icon"),g=m("el-button"),P=m("el-skeleton"),U=m("el-tag"),R=m("el-input-number"),I=m("el-empty");return i(),r("div",os,[s("div",ls,[s("div",rs,[s("h2",null,n(o.value?.paperName||"答题详情"),1),s("div",is,[s("span",null,n(o.value?.bankName||"未知题库"),1),t[1]||(t[1]=s("span",{class:"divider"},"|",-1)),s("span",null,"总分: "+n(o.value?.score?.totalScore||0)+"/"+n(o.value?.score?.maxScore||0),1),t[2]||(t[2]=s("span",{class:"divider"},"|",-1)),s("span",null,"答题时间: "+n(h(ts)(o.value?.score?.createTime)),1)])]),s("div",cs,[l(g,{onClick:D},{default:p(()=>[l(_,null,{default:p(()=>[l(h(X))]),_:1}),t[3]||(t[3]=y(" 返回 ",-1))]),_:1})])]),A.value?(i(),r("div",us,[l(P,{rows:8,animated:""})])):o.value?(i(),r("div",ds,[s("div",vs,[s("div",_s,[t[8]||(t[8]=J('<div class="nav-title" data-v-f058492f>题目导航</div><div class="nav-legend" data-v-f058492f><div class="legend-item" data-v-f058492f><div class="legend-color correct" data-v-f058492f></div><span data-v-f058492f>正确</span></div><div class="legend-item" data-v-f058492f><div class="legend-color incorrect" data-v-f058492f></div><span data-v-f058492f>错误</span></div><div class="legend-item" data-v-f058492f><div class="legend-color current" data-v-f058492f></div><span data-v-f058492f>当前</span></div></div>',2)),s("div",ps,[(i(!0),r(E,null,H(v.value,(d,c)=>(i(),r("div",{key:d.questionId,class:k(["nav-item",{active:c===u.value,correct:d.isCorrect===!0,incorrect:d.isCorrect===!1,"multiple-choice":d.questionType==="MULTIPLE_CHOICE",analysis:d.questionType==="ANALYSIS",essay:d.questionType==="ESSAY"}]),onClick:se=>V(c),title:Y(d,c)},n(c+1),11,ms))),128))]),s("div",fs,[s("div",ws,[t[4]||(t[4]=s("span",{class:"stat-label"},"总题数:",-1)),s("span",hs,n(v.value.length),1)]),s("div",ys,[t[5]||(t[5]=s("span",{class:"stat-label"},"正确:",-1)),s("span",gs,n($.value),1)]),s("div",Cs,[t[6]||(t[6]=s("span",{class:"stat-label"},"错误:",-1)),s("span",ks,n(q.value),1)]),s("div",As,[t[7]||(t[7]=s("span",{class:"stat-label"},"得分率:",-1)),s("span",bs,n(h(as)(o.value.score.totalScore,o.value.score.maxScore)),1)])])]),s("div",Ts,[a.value?(i(),r("div",Ss,[s("div",xs,[s("span",Is,"第 "+n(u.value+1)+" 题",1),s("span",Es,n(x(a.value.questionType)),1),s("span",Hs,"("+n(a.value.scoreObtained||0)+"/"+n(a.value.maxScore||0)+" 分)",1),l(U,{type:j(a.value.isCorrect),size:"small",class:"result-tag"},{default:p(()=>[y(n(z(a.value.isCorrect)),1)]),_:1},8,["type"])]),s("div",Ns,[s("div",Qs,n(a.value.questionText),1),a.value.questionType==="MULTIPLE_CHOICE"?(i(),r("div",$s,[(i(!0),r(E,null,H(a.value.options,(d,c)=>(i(),r("div",{key:c,class:k(["option-item",{"correct-answer":c===a.value.correctAnswer,"user-answer":c===a.value.userAnswer,"wrong-answer":c===a.value.userAnswer&&!a.value.isCorrect}])},[s("span",qs,n(c)+".",1),s("span",Ls,n(d),1),c===a.value.correctAnswer?(i(),r("span",Ds,[l(_,null,{default:p(()=>[l(h(K))]),_:1})])):c===a.value.userAnswer&&!a.value.isCorrect?(i(),r("span",Vs,[l(_,null,{default:p(()=>[l(h(ss))]),_:1})])):Z("",!0)],2))),128)),s("div",Ms,[s("div",Os,[t[9]||(t[9]=s("span",{class:"answer-label"},"正确答案:",-1)),s("span",Bs,n(a.value.correctAnswer),1)]),s("div",Ys,[t[10]||(t[10]=s("span",{class:"answer-label"},"您的答案:",-1)),s("span",{class:k(["answer-value",{correct:a.value.isCorrect,wrong:!a.value.isCorrect}])},n(a.value.userAnswer||"未作答"),3)])])])):(i(),r("div",js,[s("div",zs,[s("div",Ps,n(a.value.questionType==="ESSAY"?"参考答案":"标准答案")+": ",1),s("div",Us,n(a.value.referenceAnswer||a.value.correctAnswer),1)]),s("div",Rs,[t[11]||(t[11]=s("div",{class:"answer-title"},"您的答案:",-1)),s("div",{class:k(["answer-content user",{empty:!a.value.userAnswer}])},n(a.value.userAnswer||"未作答"),3)])]))]),s("div",Gs,[s("div",Fs,[l(g,{onClick:M,disabled:u.value===0},{default:p(()=>[...t[12]||(t[12]=[y(" 上一题 ",-1)])]),_:1},8,["disabled"]),l(g,{type:"primary",onClick:O,disabled:u.value===v.value.length-1},{default:p(()=>[...t[13]||(t[13]=[y(" 下一题 ",-1)])]),_:1},8,["disabled"])]),s("div",Js,[t[15]||(t[15]=s("span",null,"跳转到第",-1)),l(R,{modelValue:b.value,"onUpdate:modelValue":t[0]||(t[0]=d=>b.value=d),min:1,max:v.value.length,size:"small",style:{width:"80px",margin:"0 8px"}},null,8,["modelValue","max"]),t[16]||(t[16]=s("span",null,"题",-1)),l(g,{size:"small",onClick:B},{default:p(()=>[...t[14]||(t[14]=[y("跳转",-1)])]),_:1})])])])):(i(),r("div",Ws,[l(I,{description:"暂无答题数据"})]))])])])):(i(),r("div",Xs,[l(I,{description:"未找到相关数据"})]))])}}},oe=ns(Zs,[["__scopeId","data-v-f058492f"]]);export{oe as default};
