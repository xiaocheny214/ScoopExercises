import{a5 as y,r as u,k as t,A as r}from"./index-D6KW0YUS.js";const h=y("questionBank",()=>{const o=u([]),l=u([]),g=u(null),i=u({page:0,size:10,totalElements:0,totalPages:0}),c=u(!1),m=s=>{o.value=s},f=s=>{g.value=s},d=async s=>{try{const e=await t.post(r.QUESTION_BANK.CREATE,s);return e.success===!0?(await n(),{success:!0,message:e.message||"题库创建成功",data:e.data}):{success:!1,message:e.message||"创建失败"}}catch(e){return{success:!1,message:e.message||"创建题库失败"}}},B=async s=>{try{const e=await t.get(`${r.QUESTION_BANK.GET}/${s}`);return e.success===!0?(f(e.data),{success:!0,data:e.data}):{success:!1,message:e.message||"获取题库失败"}}catch(e){return{success:!1,message:e.message||"获取题库失败"}}},n=async()=>{c.value=!0;try{const s=await t.get(r.QUESTION_BANK.LIST);return s.success===!0?(m(s.data||[]),{success:!0,data:s.data}):{success:!1,message:s.message||"加载题库列表失败"}}catch(s){return{success:!1,message:s.message||"加载题库列表失败"}}finally{c.value=!1}};return{questionBanks:o,papers:l,currentBank:g,pagination:i,loading:c,setQuestionBanks:m,setCurrentBank:f,createQuestionBank:d,getQuestionBank:B,loadQuestionBanks:n,loadQuestionBanksPage:async(s=0,e=10)=>{c.value=!0;try{const a=await t.get(`${r.QUESTION_BANK.PAGE}?page=${s}&size=${e}`);return a.success===!0?(m(a.data.content||[]),i.value={page:a.data.page,size:a.data.size,totalElements:a.data.totalElements,totalPages:a.data.totalPages},{success:!0,data:a.data}):{success:!1,message:a.message||"加载题库列表失败"}}catch(a){return{success:!1,message:a.message||"加载题库列表失败"}}finally{c.value=!1}},updateQuestionBank:async s=>{try{const e=await t.put(r.QUESTION_BANK.UPDATE,s);return e.success===!0?(await n(),{success:!0,message:e.message||"题库更新成功"}):{success:!1,message:e.message||"更新失败"}}catch(e){return{success:!1,message:e.message||"更新题库失败"}}},deleteQuestionBank:async s=>{try{const e=await t.delete(`${r.QUESTION_BANK.DELETE}/${s}`);return e.success===!0?(await n(),{success:!0,message:e.message||"题库删除成功"}):{success:!1,message:e.message||"删除失败"}}catch(e){return{success:!1,message:e.message||"删除题库失败"}}},batchDeleteQuestionBanks:async s=>{try{const e=await t.post(r.QUESTION_BANK.BATCH_DELETE,s);return e.success===!0?(await n(),{success:!0,message:e.message||"批量删除成功"}):{success:!1,message:e.message||"批量删除失败"}}catch(e){let a="批量删除失败";return e.message&&e.message.includes("Referential integrity constraint violation")?a="无法删除题库：该题库下还有试卷，请先删除相关试卷后再删除题库":e.message&&(a=e.message),{success:!1,message:a}}},resetState:()=>{o.value=[],g.value=null,i.value={page:0,size:10,totalElements:0,totalPages:0},c.value=!1},getQuestionBanks:async()=>{try{return await n()}catch{return{success:!1,message:"获取题库列表失败"}}},getPapersByBankId:async s=>{try{return l.value=[],{success:!0,data:[]}}catch{return{success:!1,message:"获取试卷列表失败"}}},getAllPapers:async()=>{try{return l.value=[],{success:!0,data:[]}}catch{return{success:!1,message:"获取试卷列表失败"}}}}});export{h as u};
