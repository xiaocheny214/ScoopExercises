import{r as h,a6 as ee,m as b,p as se,E as I,c as i,b as t,t as n,h as y,d as r,w as _,f as m,a3 as te,Q as O,R as U,Y as T,g as ae,o as c,j as C,a7 as ne,K as oe,a8 as re,$ as le}from"./index-BVGhpotA.js";import{u as ie}from"./history-CxXN_IVo.js";import{a as ce,b as ue}from"./format-XwD1px1m.js";import{_ as de}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ve={class:"history-detail-container"},pe={class:"detail-header"},_e={class:"header-info"},me={class:"header-meta"},fe={class:"header-actions"},he={key:0,class:"loading-container"},ye={key:1,class:"detail-content"},Ce={class:"detail-area"},ge={class:"question-nav"},we={class:"nav-grid"},be=["onClick","title"],Te={class:"nav-stats"},Se={class:"stat-item"},ke={class:"stat-value"},Ee={class:"stat-item"},Ie={class:"stat-value correct"},Ae={class:"stat-item"},xe={class:"stat-value incorrect"},He={class:"stat-item"},Le={class:"stat-value"},Oe={class:"question-content"},Ue={key:0,class:"question-wrapper"},Ne={class:"question-header"},Qe={class:"question-number"},$e={class:"question-type"},Me={class:"question-score"},De={class:"question-body"},Pe={class:"question-text"},Ve={key:0,class:"question-options"},Ge={class:"option-label"},Ye={class:"option-text"},je={key:0,class:"answer-mark correct"},qe={key:1,class:"answer-mark wrong"},Be={class:"answer-summary"},ze={class:"answer-row"},Fe={class:"answer-value correct"},Re={class:"answer-row"},Je={key:1,class:"text-answers"},We={class:"answer-section"},Xe={class:"answer-title"},Ze={class:"answer-content standard"},Ke={class:"answer-section"},es={class:"question-actions"},ss={class:"nav-buttons"},ts={class:"jump-input"},as={key:1,class:"no-question"},ns={key:2,class:"error-container"},os={__name:"HistoryDetail",setup(rs){const A=ee(),f=ae(),N=ie(),S=h(!1),o=h(null),Q=h(A.params.id),v=h(0),k=h(1),p=b(()=>{if(!o.value?.userAnswer)return[];const e=[];return o.value.userAnswer.multipleChoice&&e.push(...o.value.userAnswer.multipleChoice),o.value.userAnswer.analysis&&e.push(...o.value.userAnswer.analysis),o.value.userAnswer.essay&&e.push(...o.value.userAnswer.essay),e}),a=b(()=>p.value[v.value]||null),$=b(()=>p.value.filter(e=>e.isCorrect===!0).length),M=b(()=>p.value.filter(e=>e.isCorrect===!1).length);se(()=>{D()});const D=async()=>{S.value=!0;try{const e=await N.getHistoryDetail(Q.value);e.success?(o.value=e.data,console.log("详情数据:",e.data)):I.error(e.message||"加载详情失败")}catch(e){console.error("加载详情失败:",e),I.error("加载详情失败")}finally{S.value=!1}},P=()=>{const e=A.query.from;if(e==="home")f.push({name:"Home"});else if(e==="history")f.push({name:"History"});else try{window.history.length>1?f.go(-1):f.push({name:"History"})}catch{f.push({name:"History"})}},V=e=>{e>=0&&e<p.value.length&&(v.value=e)},G=()=>{v.value>0&&v.value--},Y=()=>{v.value<p.value.length-1&&v.value++},j=()=>{const e=k.value-1;e>=0&&e<p.value.length?v.value=e:I.warning("请输入有效的题目序号")},q=(e,s)=>{let u=`第${s+1}题 - ${x(e.questionType)}`;return e.isCorrect===!0?u+=`
✓ 正确 (${e.scoreObtained}/${e.maxScore}分)`:e.isCorrect===!1?u+=`
✗ 错误 (${e.scoreObtained}/${e.maxScore}分)`:u+=`
待评分 (${e.scoreObtained}/${e.maxScore}分)`,u},x=e=>({SINGLE_CHOICE:"单选题",MULTIPLE_CHOICE:"多选题",ANALYSIS:"分析题",ESSAY:"解答题"})[e]||"题目",B=e=>e===!0?"success":e===!1?"danger":"warning",z=e=>e===!0?"正确":e===!1?"错误":"待评分",g=(e,s)=>s?s.includes(",")?s.split(",").map(u=>u.trim().toUpperCase()).includes(e.toUpperCase()):s.trim().toUpperCase()===e.toUpperCase():!1,E=(e,s)=>s?s.includes(",")?s.split(",").map(u=>u.trim().toUpperCase()).includes(e.toUpperCase()):s.trim().toUpperCase()===e.toUpperCase():!1,F=e=>e?e.includes(",")?e.split(",").map(s=>s.trim()).sort().join(", "):e.trim():"无",R=e=>e?e.includes(",")?e.split(",").map(s=>s.trim()).sort().join(", "):e.trim():"",J=e=>e?e.questionType==="ESSAY"?e.referenceAnswer||"无参考答案":e.correctAnswer||"无标准答案":"无标准答案",H=e=>{if(!e)return"";const s=e.userAnswer||"";return e.questionType!=="SINGLE_CHOICE"&&e.questionType!=="MULTIPLE_CHOICE"&&/^[A-F](,[A-F])*$/i.test(s.trim())?"":s},W=e=>!e||e.questionType!=="SINGLE_CHOICE"&&e.questionType!=="MULTIPLE_CHOICE"?{}:e.options||{};return(e,s)=>{const u=m("el-icon"),w=m("el-button"),X=m("el-skeleton"),Z=m("el-tag"),K=m("el-input-number"),L=m("el-empty");return c(),i("div",ve,[t("div",pe,[t("div",_e,[t("h2",null,n(o.value?.paperName||"答题详情"),1),t("div",me,[t("span",null,n(o.value?.bankName||"未知题库"),1),s[1]||(s[1]=t("span",{class:"divider"},"|",-1)),t("span",null,"总分: "+n(o.value?.score?.totalScore||0)+"/"+n(o.value?.score?.maxScore||0),1),s[2]||(s[2]=t("span",{class:"divider"},"|",-1)),t("span",null,"答题时间: "+n(y(ce)(o.value?.score?.createTime)),1)])]),t("div",fe,[r(w,{onClick:P},{default:_(()=>[r(u,null,{default:_(()=>[r(y(ne))]),_:1}),s[3]||(s[3]=C(" 返回 ",-1))]),_:1})])]),S.value?(c(),i("div",he,[r(X,{rows:8,animated:""})])):o.value?(c(),i("div",ye,[t("div",Ce,[t("div",ge,[s[8]||(s[8]=te('<div class="nav-title" data-v-0b01e9f5>题目导航</div><div class="nav-legend" data-v-0b01e9f5><div class="legend-item" data-v-0b01e9f5><div class="legend-color correct" data-v-0b01e9f5></div><span data-v-0b01e9f5>正确</span></div><div class="legend-item" data-v-0b01e9f5><div class="legend-color incorrect" data-v-0b01e9f5></div><span data-v-0b01e9f5>错误</span></div><div class="legend-item" data-v-0b01e9f5><div class="legend-color current" data-v-0b01e9f5></div><span data-v-0b01e9f5>当前</span></div></div>',2)),t("div",we,[(c(!0),i(O,null,U(p.value,(d,l)=>(c(),i("div",{key:d.questionId,class:T(["nav-item",{active:l===v.value,correct:d.isCorrect===!0,incorrect:d.isCorrect===!1,"single-choice":d.questionType==="SINGLE_CHOICE","multiple-choice":d.questionType==="MULTIPLE_CHOICE",analysis:d.questionType==="ANALYSIS",essay:d.questionType==="ESSAY"}]),onClick:ls=>V(l),title:q(d,l)},n(l+1),11,be))),128))]),t("div",Te,[t("div",Se,[s[4]||(s[4]=t("span",{class:"stat-label"},"总题数:",-1)),t("span",ke,n(p.value.length),1)]),t("div",Ee,[s[5]||(s[5]=t("span",{class:"stat-label"},"正确:",-1)),t("span",Ie,n($.value),1)]),t("div",Ae,[s[6]||(s[6]=t("span",{class:"stat-label"},"错误:",-1)),t("span",xe,n(M.value),1)]),t("div",He,[s[7]||(s[7]=t("span",{class:"stat-label"},"得分率:",-1)),t("span",Le,n(y(ue)(o.value.score.totalScore,o.value.score.maxScore)),1)])])]),t("div",Oe,[a.value?(c(),i("div",Ue,[t("div",Ne,[t("span",Qe,"第 "+n(v.value+1)+" 题",1),t("span",$e,n(x(a.value.questionType)),1),t("span",Me,"("+n(a.value.scoreObtained||0)+"/"+n(a.value.maxScore||0)+" 分)",1),r(Z,{type:B(a.value.isCorrect),size:"small",class:"result-tag"},{default:_(()=>[C(n(z(a.value.isCorrect)),1)]),_:1},8,["type"])]),t("div",De,[t("div",Pe,n(a.value.questionText),1),a.value.questionType==="SINGLE_CHOICE"||a.value.questionType==="MULTIPLE_CHOICE"?(c(),i("div",Ve,[(c(!0),i(O,null,U(W(a.value),(d,l)=>(c(),i("div",{key:l,class:T(["option-item",{"correct-answer":g(l,a.value.correctAnswer),"user-answer":E(l,a.value.userAnswer),"wrong-answer":E(l,a.value.userAnswer)&&!g(l,a.value.correctAnswer)}])},[t("span",Ge,n(l)+".",1),t("span",Ye,n(d),1),g(l,a.value.correctAnswer)?(c(),i("span",je,[r(u,null,{default:_(()=>[r(y(re))]),_:1})])):E(l,a.value.userAnswer)&&!g(l,a.value.correctAnswer)?(c(),i("span",qe,[r(u,null,{default:_(()=>[r(y(le))]),_:1})])):oe("",!0)],2))),128)),t("div",Be,[t("div",ze,[s[9]||(s[9]=t("span",{class:"answer-label"},"正确答案:",-1)),t("span",Fe,n(F(a.value.correctAnswer)),1)]),t("div",Re,[s[10]||(s[10]=t("span",{class:"answer-label"},"您的答案:",-1)),t("span",{class:T(["answer-value",{correct:a.value.isCorrect,wrong:!a.value.isCorrect}])},n(R(a.value.userAnswer)||"未作答"),3)])])])):(c(),i("div",Je,[t("div",We,[t("div",Xe,n(a.value.questionType==="ESSAY"?"参考答案":"标准答案")+": ",1),t("div",Ze,n(J(a.value)),1)]),t("div",Ke,[s[11]||(s[11]=t("div",{class:"answer-title"},"您的答案:",-1)),t("div",{class:T(["answer-content user",{empty:!H(a.value)}])},n(H(a.value)||"未作答"),3)])]))]),t("div",es,[t("div",ss,[r(w,{onClick:G,disabled:v.value===0},{default:_(()=>[...s[12]||(s[12]=[C(" 上一题 ",-1)])]),_:1},8,["disabled"]),r(w,{type:"primary",onClick:Y,disabled:v.value===p.value.length-1},{default:_(()=>[...s[13]||(s[13]=[C(" 下一题 ",-1)])]),_:1},8,["disabled"])]),t("div",ts,[s[15]||(s[15]=t("span",null,"跳转到第",-1)),r(K,{modelValue:k.value,"onUpdate:modelValue":s[0]||(s[0]=d=>k.value=d),min:1,max:p.value.length,size:"small",style:{width:"80px",margin:"0 8px"}},null,8,["modelValue","max"]),s[16]||(s[16]=t("span",null,"题",-1)),r(w,{size:"small",onClick:j},{default:_(()=>[...s[14]||(s[14]=[C("跳转",-1)])]),_:1})])])])):(c(),i("div",as,[r(L,{description:"暂无答题数据"})]))])])])):(c(),i("div",ns,[r(L,{description:"未找到相关数据"})]))])}}},vs=de(os,[["__scopeId","data-v-0b01e9f5"]]);export{vs as default};
